



AWS Crypto Tools                                            . Amazon AWS
                                                              Amazon AWS
                                                       21 September 2021


                            message-body-aad
                            message-body-aad

Abstract

   The message-body-aad specification for the AWS Encryption SDK.

Table of Contents

   1.  Conventions and Definitions
   2.  Message Body AAD
     2.1.  Version
     2.2.  Implementations
     2.3.  Overview
     2.4.  Structure
       2.4.1.  Message ID
       2.4.2.  Body AAD Content
       2.4.3.  Sequence Number
       2.4.4.  Content Length
   3.  Normative References
   Acknowledgments
   Author's Address

1.  Conventions and Definitions

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in BCP
   14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here

2.  Message Body AAD

2.1.  Version

   See Message Version (message.md#version).

2.2.  Implementations

   *  C (https://github.com/aws/aws-encryption-sdk-c/blob/master/source/
      cipher.c)

   *  JavaScript (https://github.com/awslabs/aws-encryption-sdk-
      javascript/blob/master/modules/serialize/src/aad_factory.ts)

   *  Python (https://github.com/aws/aws-encryption-sdk-
      python/blob/master/src/aws_encryption_sdk/internal/formatting/
      encryption_context.py)

   *  Java (https://github.com/aws/aws-encryption-sdk-
      java/blob/master/src/main/java/com/amazonaws/encryptionsdk/
      internal/Utils.java)

2.3.  Overview

   The message body AAD is the serialization of the AAD to be used as
   input to encryption of the message body.

2.4.  Structure

   The following describes the fields that form the message body AAD.
   The bytes are appended in the order shown.

          +==================+================+================+
          | Field            | Length (bytes) | Interpreted as |
          +==================+================+================+
          | Message ID       | 16             | Bytes          |
          +------------------+----------------+----------------+
          | Body AAD Content | Variable.      | UTF-8 Bytes    |
          +------------------+----------------+----------------+
          | Sequence Number  | 4              | Uint32         |
          +------------------+----------------+----------------+
          | Content Length   | 8              | Uint64         |
          +------------------+----------------+----------------+

                                 Table 1

2.4.1.  Message ID

   An identifier for the message (message.md) this message body AAD is
   associated with.

2.4.2.  Body AAD Content

   An identifier for the content type of the data this message body AAD
   is associated with.

   This value depends on the content type (message-header.md#content-
   type) of the message (message.md):

   *  Non-framed data (message-body.md#non-framed-data) MUST use the
      value "AWSKMSEncryptionClient Single Block".

   *  The regular frames (message-body.md#regular-frame) in framed data
      (message-body.md#framed-data) MUST use the value
      "AWSKMSEncryptionClient Frame".

   *  The final frame (message-body.md#final-frame) in framed data
      (message-body.md#framed-data) MUST use the value
      "AWSKMSEncryptionClient Final Frame".

2.4.3.  Sequence Number

   The sequence number of the data this message body AAD belongs to.
   For framed data (message-body.md#framed-data), the value of this
   field MUST be the frame sequence number (message-body.md#sequence-
   number).  For non-framed data (message-body.md#non-framed-data), the
   value of this field MUST be "1".

2.4.4.  Content Length

   The length, in bytes, of the plaintext data being encrypted that this
   message body AAD is associated with.

   More specifically, depending on the content type (message-
   header.md#content-type) of the message (message.md):

   *  For non-framed data (message-body.md#non-framed-data), this value
      MUST equal the length, in bytes, of the plaintext data provided to
      the algorithm for encryption.

   *  For framed data (message-body.md#framed-data), this value MUST
      equal the length, in bytes, of the plaintext being encrypted in
      this frame.

      -  For regular frames (message-body.md#regular-frame), this value
         MUST equal the value of the frame length (message-
         header.md#frame-length) field in the message header.

      -  For the final frame (message-body.md#final-frame), this value
         MUST be greater than or equal to 0 and less than or equal to
         the value of the frame length (message-header.md#frame-length)
         field in the message header.

3.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/info/rfc8174>.

Acknowledgments

Author's Address

   Amazon AWS
   Amazon AWS

   Email: cryptools+rfc@amazon.com
