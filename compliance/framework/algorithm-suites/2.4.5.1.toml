target = "compliance/framework/algorithm-suites.txt#2.4.5.1"

# 2.4.5.1.  HKDF Encryption Key
#
# If an algorithm suite uses HKDF to derive the encryption key the AWS
# Encryption SDK MUST use HKDF with the following specifics:
# 
# *  The hash function MUST be specified by the algorithm suite key
#    derivation settings (Section 2.6).
# 
# *  For the extract step:
# 
#    -  The input keying material MUST be the data key generated by the
#       key provider.
# 
#    -  The length of the input keying material MUST equal the key
#       derivation input length (Section 2.10.8) specified by the
#       algorithm suite encryption key derivation settings
#       (Section 2.6).
# 
#    -  If there is no salt length defined for the algorithm suite
#       encryption key derivation commitment setting (Section 2.6), the
#       the salt MUST be a byte sequence of 0 as long as the hash
#       length in bytes.
# 
#    -  If salt length is defined for the algorithm suite encryption
#       key derivation commitment setting (Section 2.6), the salt MUST
#       be the message ID (../data-format/message-header.md#message-id)
#       with a length equal to the salt length.
# 
# *  For the expand step:
# 
#    -  The input pseudorandom key MUST be the output from the extract
#       step.
# 
#    -  The length of the output keying material MUST equal the
#       encryption key length (Section 2.10.4) specified by the
#       algorithm suite encryption settings (Section 2.7).
# 
#    -  If key commitment (Section 2.10.9) for the algorithm suite
#       encryption key derivation setting (Section 2.6) is True, then
#       the input info MUST be the string "DERIVEKEY" as UTF8 encoded
#       bytes.
# 
#    -  If key commitment (Section 2.10.9) for the algorithm suite
#       encryption key derivation setting (Section 2.6) is False, the
#       the input info MUST be a concatenation of the algorithm suite
#       ID (Section 2.10.1) followed by the message ID (../data-format/
#       message-header.md#message-id).

[[spec]]
level = "MUST"
quote = '''
If an algorithm suite uses HKDF to derive the encryption key the AWS
Encryption SDK MUST use HKDF with the following specifics:
'''

[[spec]]
level = "MUST"
quote = '''
*  The hash function MUST be specified by the algorithm suite key
derivation settings (Section 2.6).
'''

[[spec]]
level = "MUST"
quote = '''
-  The input keying material MUST be the data key generated by the
key provider.
'''

[[spec]]
level = "MUST"
quote = '''
-  The length of the input keying material MUST equal the key
derivation input length (Section 2.10.8) specified by the
algorithm suite encryption key derivation settings
(Section 2.6).
'''

[[spec]]
level = "MUST"
quote = '''
-  If there is no salt length defined for the algorithm suite
encryption key derivation commitment setting (Section 2.6), the
the salt MUST be a byte sequence of 0 as long as the hash
length in bytes.
'''

[[spec]]
level = "MUST"
quote = '''
-  If salt length is defined for the algorithm suite encryption
key derivation commitment setting (Section 2.6), the salt MUST
be the message ID (../data-format/message-header.md#message-id)
with a length equal to the salt length.
'''

[[spec]]
level = "MUST"
quote = '''
-  The input pseudorandom key MUST be the output from the extract
step.
'''

[[spec]]
level = "MUST"
quote = '''
-  The length of the output keying material MUST equal the
encryption key length (Section 2.10.4) specified by the
algorithm suite encryption settings (Section 2.7).
'''

[[spec]]
level = "MUST"
quote = '''
-  If key commitment (Section 2.10.9) for the algorithm suite
encryption key derivation setting (Section 2.6) is True, then
the input info MUST be the string "DERIVEKEY" as UTF8 encoded
bytes.
'''

[[spec]]
level = "MUST"
quote = '''
-  If key commitment (Section 2.10.9) for the algorithm suite
encryption key derivation setting (Section 2.6) is False, the
the input info MUST be a concatenation of the algorithm suite
ID (Section 2.10.1) followed by the message ID (../data-format/
message-header.md#message-id).
'''

