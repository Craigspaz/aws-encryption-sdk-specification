target = "compliance/framework/kms-keyring.txt#2.5.3"

# 2.5.3.  Generator
#
# A string that identifies an AWS KMS customer master key (CMK)
# (https://docs.aws.amazon.com/kms/latest/developerguide/
# concepts.html#key-id) that the AWS KMS keyring uses to generate,
# encrypt, and decrypt data keys.
# 
# The AWS KMS keyring accepts any value for a generator that is
# accepted by AWS KMS as a key identifer
# (https://docs.aws.amazon.com/kms/latest/developerguide/
# concepts.html#key-id).  The AWS KMS keyring does not validate any
# value for a generator and passes this information to AWS KMS.
# 
# Note that only generators in the key ARN format
# (https://docs.aws.amazon.com/general/latest/gr/aws-arns-and-
# namespaces.html#arn-syntax-kms) are used for decryption because
# encrypted data keys constructed by the AWS KMS keyring always store
# the ID of the CMK used to encrypt it in the key ARN format and
# Section 2.7.2 checks the generator against that value before
# attempting decryption.
# 
# The generator SHOULD NOT be included in the key names
# (Section 2.5.2), otherwise this CMK is used to encrypt the plaintext
# data key twice.
# 
# The AWS KMS caller MUST have kms:GenerateDataKey
# (https://docs.aws.amazon.com/kms/latest/developerguide/kms-api-
# permissions-reference.html#AWS-KMS-API-Operations-and-Permissions)
# permission for the AWS KMS CMK specified by the generator.

[[spec]]
level = "SHOULD"
quote = '''
The generator SHOULD NOT be included in the key names
(Section 2.5.2), otherwise this CMK is used to encrypt the plaintext
data key twice.
'''

[[spec]]
level = "MUST"
quote = '''
The AWS KMS caller MUST have kms:GenerateDataKey
(https://docs.aws.amazon.com/kms/latest/developerguide/kms-api-
permissions-reference.html#AWS-KMS-API-Operations-and-Permissions)
permission for the AWS KMS CMK specified by the generator.
'''

